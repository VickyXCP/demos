<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale= 1">
  <title>上拉加载</title>
  <style>
    *{
      margin: 0;
      padding: 0;
    }
    html,body{
      width: 100%;
    }

    ul{
      list-style-type: none;
    }
    li{
      padding: 20px;
      border-bottom: 1px solid #eff;
      background-color: #eee;
    }
    .refreshText{
      width: 100%;
      line-height: 50px;
      text-align: center;
    }
  </style>
</head>
<body>
  <main>
    <ul id="refreshContainer">
      <li>111</li>
      <li>111</li>
      <li>111</li>
      <li>111</li>
      <li>111</li>
      <li>111</li>
      <li>111</li>
      <li>111</li>
      <li>111</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111d</li>
      <li>111dd</li>
    </ul>
    <p class="refreshText"></p>
  </main>

  <script>
    (function(window){

      var text = document.querySelector('.refreshText'),
        container = document.getElementById('refreshContainer')

    //  获取当前滚动条的位置
      function getScrollTop(){
        var scrollTop = 0
        if (document.documentElement && document.documentElement.scrollTop){
          scrollTop = document.documentElement.scrollTop
        } else if (document.body){
          scrollTop = document.body.scrollTop
        }
        return scrollTop
      }

    //  获取当前可视范围的高度
      function getClientHeight () {
        var clientHeight = 0
        if (document.body.clientHeight && document.documentElement.clientHeight){
          clientHeight = Math.min(document.body.clientHeight, document.documentElement.clientHeight)
        } else {
          clientHeight = Math.max(document.body.clientHeight, document.documentElement.clientHeight)
        }
        return clientHeight
      }

    //  获取文档完整高度
      function getScrollHeight () {
        return Math.max(document.body.scrollHeight, document.documentElement.scrollHeight)
      }

    /*//  节流函数
      var throttle = function(method, context){
        clearTimeout(method.tId)
        method.tId = setTimeout(function () {
          method.call(context)
        }, 300)
      }

      function fetchData () {
        setTimeout(function () {
          container.insertAdjacentElement('beforeend', '<li>new add···</li>')
        },1000)
      }
*/
      window.onscroll = function(){
        if (getScrollTop() + getClientHeight() == getScrollHeight()){
          text.textContent = '加载中···'
          // throttle(fetchData())
        }
      }

    })(window)
  </script>
</body>
</html>
